<!doctype html>
<html lang="en">

    <head>
        
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

        
        <link rel="icon" href="https://www.petfactory.se/favicons/favicon-32.png" sizes="32x32">

        
        
        
        <link rel="apple-touch-icon" href="https://www.petfactory.se/favicons/favicon-180.png" sizes="180x180">

        
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

        
        <link rel="stylesheet" href="https://www.petfactory.se/css/style.css">
        <link rel="stylesheet" href="https://www.petfactory.se/css/syntax.css">
        <link href="https://fonts.googleapis.com/css2?family=Hind:wght@400;500&display=swap" rel="stylesheet">
        <title>Petfactory | UE4 - Pipeline</title>
        <meta name="description" content="Petfactory | Design and Animation | UE4 - Pipeline" />

    </head>

    <body>

        <div class="site-header"> 

            <div class="container main-nav-wrap">
                 
                <a class="py-2 home-icon" href="https://www.petfactory.se/">
                    <div class="header-logo-wrap">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="#e83e8c" width="18" height="18" viewBox="0 0 61.44 61.67"><path class="a" d="M1.28,45.25V56.6a6,6,0,0,0,6,6H18.64A27.07,27.07,0,0,1,8,55.93,25.6,25.6,0,0,1,1.28,45.25Z" transform="translate(-1.28 -1.17)"/><path class="a" d="M28,7.85a27.08,27.08,0,0,1,19.37,7.79L52,20.31,41.35,31,36.9,26.55A13.24,13.24,0,0,0,28,23a12.91,12.91,0,1,0,0,25.82,13.24,13.24,0,0,0,8.9-3.56L62.72,19.42V7.18a6,6,0,0,0-6-6H7.29a6.33,6.33,0,0,0-6,6.23V26.77A28.27,28.27,0,0,1,28,7.85Z" transform="translate(-1.28 -1.17)"/><path class="a" d="M47.36,56.6a27,27,0,0,1-10.24,6.23H56.49a6,6,0,0,0,6-6V41.46Z" transform="translate(-1.28 -1.17)"/></svg>
                        
                    </div>
                </a>

                <nav id="main-nav">
    <ul id="main-menu">
        
        
            
                <li>
                    <a href="https://www.petfactory.se/about">
                        
                        <span>ABOUT</span>
                    </a>
                </li>
            
        
            
                <li>
                    <a href="https://www.petfactory.se/work">
                        
                        <span>WORK</span>
                    </a>
                </li>
            
        
            
                <li>
                    <a href="https://www.petfactory.se/cv">
                        
                        <span>CV</span>
                    </a>
                </li>
            
        
            
                <li class="">
                    <a href="https://www.petfactory.se/notes">  
                        
                        <span>NOTES</span>
                    </a>
                    <ul class="sub-menu">
                        
                            <li class="">
                                <a href="https://www.petfactory.se/tags/python-notes">Python</a>
                            </li>
                        
                            <li class="">
                                <a href="https://www.petfactory.se/tags/houdini-notes">Houdini</a>
                            </li>
                        
                            <li class="">
                                <a href="https://www.petfactory.se/tags/unreal-engine-notes">Unreal Engine</a>
                            </li>
                        
                            <li class="">
                                <a href="https://www.petfactory.se/tags/davinci-resolve-notes">DaVinci Resolve</a>
                            </li>
                        
                    </ul>
                </li>
            
        
    </ul>
</nav>

            </div>
            
        </div>


        <div class="site-header-mobile"> 

            
            <div class="menu-wrap">

                <ul>
                    <li><a class="menu-wrap-a" href="https://www.petfactory.se/about">ABOUT</a></li>
                    <li><a class="menu-wrap-a" href="https://www.petfactory.se/work">WORK</a></li>
                    <li><a class="menu-wrap-a" href="https://www.petfactory.se/cv">CV</a></li>
                    <li><a class="menu-wrap-a" href="https://www.petfactory.se/notes">NOTES</a></li>
                </ul>

                
                
                <div id="social-list-modal-wrap">
                    <ul id="social-list-modal">
                        <li><a target="_blank" class="" href="https://twitter.com/johanBorgstrom"><svg fill="#444" width="20" height="20" viewBox="0 0 16 16"><path d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/></svg>
</a></li>
                        
                        <li><a target="_blank" class="" href="https://www.youtube.com/channel/UCvk7lMI0ihnUr4KSfTlPEfQ"><svg fill="#444" width="20" height="20" viewBox="0 0 64 64"><path d="M54.15,10.031l-20.9-0.019l-21.718,0.019c-5.433,0-11.534,3.626-11.534,8.944v26.474c0,5.316,6.101,8.559,11.534,8.559 H54.15c5.432,0,9.834-3.242,9.834-8.559V18.976C63.984,13.657,59.582,10.031,54.15,10.031z M27.856,42.205L27.73,22.044 l14.03,10.168L27.856,42.205z"/></svg>




</a></li>
                        <li><a target="_blank" class="" href="https://github.com/petfactory"><svg fill="#444" width="20" height="20" viewBox="0 0 16 16"><path d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</a></li>
                        <li><a target="_blank" class="" href="https://linkedin.com/in/johan-borgstr%c3%b6m-8b06875"><svg fill="#444" width="20" height="20" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="1.414"><path d="M13.632 13.635h-2.37V9.922c0-.886-.018-2.025-1.234-2.025-1.235 0-1.424.964-1.424 1.96v3.778h-2.37V6H8.51V7.04h.03c.318-.6 1.092-1.233 2.247-1.233 2.4 0 2.845 1.58 2.845 3.637v4.188zM3.558 4.955c-.762 0-1.376-.617-1.376-1.377 0-.758.614-1.375 1.376-1.375.76 0 1.376.617 1.376 1.375 0 .76-.617 1.377-1.376 1.377zm1.188 8.68H2.37V6h2.376v7.635zM14.816 0H1.18C.528 0 0 .516 0 1.153v13.694C0 15.484.528 16 1.18 16h13.635c.652 0 1.185-.516 1.185-1.153V1.153C16 .516 15.467 0 14.815 0z" fill-rule="nonzero"/></svg></a></li>
                    </ul>
                </div>

            </div>

            <div class="container">

                <a class="py-2 home-icon" href="https://www.petfactory.se/">
                    <div class="header-logo-wrap">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="#e83e8c" width="18" height="18" viewBox="0 0 61.44 61.67"><path class="a" d="M1.28,45.25V56.6a6,6,0,0,0,6,6H18.64A27.07,27.07,0,0,1,8,55.93,25.6,25.6,0,0,1,1.28,45.25Z" transform="translate(-1.28 -1.17)"/><path class="a" d="M28,7.85a27.08,27.08,0,0,1,19.37,7.79L52,20.31,41.35,31,36.9,26.55A13.24,13.24,0,0,0,28,23a12.91,12.91,0,1,0,0,25.82,13.24,13.24,0,0,0,8.9-3.56L62.72,19.42V7.18a6,6,0,0,0-6-6H7.29a6.33,6.33,0,0,0-6,6.23V26.77A28.27,28.27,0,0,1,28,7.85Z" transform="translate(-1.28 -1.17)"/><path class="a" d="M47.36,56.6a27,27,0,0,1-10.24,6.23H56.49a6,6,0,0,0,6-6V41.46Z" transform="translate(-1.28 -1.17)"/></svg>
                    </div>
                </a>

                <a href="javascript:void(0);" class="menu-icon">
                    <div class="mobile-menu-trigger">            
                        <svg fill="#fff" width="18" height="18" viewBox="0 0 18 15"><path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/><path d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/><path d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/></svg>
                    </div>
                </a>

            </div>

        </div>

        <main id="content-main-wrap">

            

<div class="top-spacer"></div>

<div class="container">
	<div class="toc-wrap">
		<aside class="toc-aside">
			<div class="toc-content visible">
				<nav id="TableOfContents">
  <ul>
    <li><a href="#general">General</a>
      <ul>
        <li><a href="#tips">Tips</a></li>
        <li><a href="#naming-convention">Naming Convention</a></li>
      </ul>
    </li>
    <li><a href="#textures">Textures</a>
      <ul>
        <li><a href="#importing">Importing</a></li>
        <li><a href="#texture-groups">Texture Groups</a></li>
        <li><a href="#size">Size</a></li>
        <li><a href="#compression">Compression</a></li>
        <li><a href="#alpha">Alpha</a></li>
        <li><a href="#texture-packing">Texture Packing</a></li>
        <li><a href="#formats">Formats</a></li>
        <li><a href="#tips-1">Tips</a></li>
      </ul>
    </li>
    <li><a href="#static-meshes">Static Meshes</a>
      <ul>
        <li><a href="#lightmaps">Lightmaps</a></li>
        <li><a href="#collision">Collision</a></li>
        <li><a href="#overdraw">Overdraw</a></li>
        <li><a href="#lod">LOD</a></li>
        <li><a href="#import">Import</a></li>
        <li><a href="#export">Export</a></li>
      </ul>
    </li>
    <li><a href="#materials">Materials</a>
      <ul>
        <li><a href="#master-material">Master Material</a>
          <ul>
            <li><a href="#concepts">Concepts</a></li>
            <li><a href="#create-a-master-material">Create a Master Material</a></li>
            <li><a href="#modify-our-master-material">Modify our master material</a></li>
          </ul>
        </li>
        <li><a href="#material-function">Material Function</a>
          <ul>
            <li><a href="#use-a-material-function">Use a material function</a></li>
          </ul>
        </li>
        <li><a href="#material-instance">Material Instance</a>
          <ul>
            <li><a href="#creating-a-material-instance">Creating a material instance</a></li>
          </ul>
        </li>
        <li><a href="#vertex-animation">Vertex Animation</a>
          <ul>
            <li><a href="#setup-vertex-animation">Setup Vertex animation</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#performance--optimization">Performance &amp; Optimization</a>
      <ul>
        <li><a href="#texture-streaming">Texture streaming</a>
          <ul>
            <li><a href="#pool-size">Pool Size</a></li>
            <li><a href="#never-stream">Never Stream</a></li>
          </ul>
        </li>
        <li><a href="#lods--merging-static-meshes">LODs &amp; merging static meshes</a>
          <ul>
            <li><a href="#lod-1">LOD</a></li>
            <li><a href="#merge-actor-tool">Merge Actor Tool</a></li>
            <li><a href="#hlod">HLOD</a></li>
          </ul>
        </li>
        <li><a href="#lighting-shadow--post-process">Lighting, Shadow &amp; Post Process</a>
          <ul>
            <li><a href="#lighting">Lighting</a></li>
            <li><a href="#build-lighting">Build Lighting</a></li>
            <li><a href="#shadowing">Shadowing</a></li>
            <li><a href="#post-pross">Post Pross</a></li>
          </ul>
        </li>
        <li><a href="#volumes">Volumes</a>
          <ul>
            <li><a href="#lightmass-importance-volumes">Lightmass Importance Volumes</a></li>
            <li><a href="#cull-distance-volumes">Cull Distance Volumes</a></li>
          </ul>
        </li>
        <li><a href="#reflections">Reflections</a>
          <ul>
            <li><a href="#higher-quality-reflections">Higher Quality Reflections</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>	
			</div>
			<div class="toc-btn"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-three-dots-vertical" viewBox="0 0 16 16">
  <path d="M9.5 13a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z"/>
</svg></div>
		</aside>	
	</div>

</div>


<div class="container notes-wrap">

	<div class="row">
		
		<div class="col-md-10 mx-auto">
			<h1>UE4 - Pipeline</h1>
			<h1 id="general">General</h1>
<h2 id="tips">Tips</h2>
<ul>
<li>System Units
<ul>
<li>UE uses centimeter (1 UE unit = 1cm)</li>
</ul>
</li>
<li>Copy assets (as text)
<ul>
<li>If you select some static meshes and <strong>Ctrl C</strong> you save the selected assets, their translation etc to the clipboard</li>
<li>You can then paste the data to a text editor. This data can the be <strong>Ctrl V</strong> in Unreal editor to &ldquo;replace&rdquo; the actors.</li>
</ul>
</li>
<li>Anti-Aliasing
<ul>
<li>Project Settings &gt; Engine &gt; Rendering &gt; Default Settings &gt; Anti-Aliasing Method</li>
</ul>
</li>
</ul>
<h2 id="naming-convention">Naming Convention</h2>
<p>Using a good naming convention is important to make the project more efficient to work with. For instance, if we have a good naming convention we can understand just by looking at the file name what the purpose of a texture is. It also helps when filtering the content browser, and make the project easier to understand by organizing the content in a logical way. It will also allow for the assets to be more easily processed with python. Here are some examples of how we could name textures:</p>
<ul>
<li><strong>SM_LargeRock_00</strong> : <strong>S</strong>tatic <strong>M</strong>esh for a large rock asset version 0</li>
<li><strong>T_LargeRock_00_BC</strong> : <strong>T</strong>exture with <strong>B</strong>ase <strong>C</strong>olor channel for a large rock asset version 0</li>
<li><strong>SKM_LargeRock_00</strong> : <strong>SK</strong>eletal <strong>M</strong>esh for a large rock asset version 0</li>
</ul>
<h1 id="textures">Textures</h1>
<h2 id="importing">Importing</h2>
<ul>
<li>You can drag and drop or use the import button in the content browser.</li>
<li>Unreal will detect if the imported texture is a normal map and apply appropriate settings.</li>
</ul>
<h2 id="texture-groups">Texture Groups</h2>
<p>Texture groups is a way to organize textures in groups. We can then use this texture groups to non destructively change texture resolution by setting the lod bias to use a smaller size. This could be done to see if we can get better performance by reducing the size of certain groups.</p>
<h2 id="size">Size</h2>
<ul>
<li>Textures should always be a <strong>power of two</strong>
<ul>
<li>2, 4, 8, 16, 32&hellip;</li>
</ul>
</li>
<li>Textures <strong>do not need to be square</strong>, just a power of 2:<br>
The reaseon that the textures needs to be square is because how they will be packed into memory and how they will be optimized using texture streaming and mipmapping.
<ul>
<li>16x128, 2048x64, &hellip;</li>
</ul>
</li>
</ul>
<h2 id="compression">Compression</h2>
<ul>
<li>
<p><strong>Change compression</strong></p>
<ul>
<li>We can change the compression for certain textures, for instance if we want to display a texture to be used as a ui element we might want to change it to <strong>UserInterface2D(RGBA)</strong> the texture will be much larger but also of much higher quality.</li>
</ul>
</li>
<li>
<p><strong>Disable SRGB</strong></p>
<ul>
<li>Normal maps and masks should have this turned off.<br>
(When importing a normal map the engine should do this automatically, but if it is missed we can do it manually here)</li>
</ul>
</li>
</ul>
<h2 id="alpha">Alpha</h2>
<p>There are 2 ways of using an alpha channel, embedded or separate.</p>
<ul>
<li><strong>Embedded</strong>
<ul>
<li>Cost 2 times more than a separate alpha.<br>
This is because the embedded alpha will come in as uncompressed.</li>
</ul>
</li>
<li><strong>Separate</strong>
<ul>
<li>Gives control of the size of the alpha texture independently of the base color texture.</li>
</ul>
</li>
</ul>
<h2 id="texture-packing">Texture Packing</h2>
<p>We can store multiple textures in one texture by packing it.</p>
<ul>
<li><strong>Texture Packing</strong>
<ul>
<li>Make sure that <strong>sRGB</strong> is <strong>disabled</strong> on the texture property.<br>
This is because we dont want the channels to be gamma corrected. Since we will use the separate channels as masks, possibly multiplied with a color, we dont want it to be gamma corrected.</li>
<li>Make sure that the <strong>Sampler Type</strong> is set to <strong>Masks</strong> on the material.</li>
</ul>
</li>
</ul>
<h2 id="formats">Formats</h2>
<ul>
<li><strong>PNG</strong> - (Embedded Alpha support)</li>
<li><strong>PSD</strong> - (Embedded Alpha support)</li>
<li><strong>TGA</strong> - (Embedded Alpha support)</li>
<li><strong>BMP</strong></li>
<li><strong>FLOAT</strong></li>
<li><strong>PCX</strong></li>
<li><strong>IPG</strong></li>
<li><strong>EXR</strong></li>
<li><strong>DDS</strong> - Cubemap Texture (32 Bits/Channel 8.8.8.8 ARGB 32 bpp, unsigned)</li>
<li><strong>HDR</strong> - Cubemap Texture (LongLat Unwrap)
<ul>
<li>The only texture that <strong>do not need to comply with power of 2</strong> when importing a hdr texture used for lighting.</li>
</ul>
</li>
</ul>
<h2 id="tips-1">Tips</h2>
<p>If you get artifacts from the mipmaps (thin lines, chain link fences etc) you could try to change the <strong>Mip Gen Settings</strong> on the texture node. This will sharpen, blur etc the mips which might help with the artifacts.</p>
<h1 id="static-meshes">Static Meshes</h1>
<h2 id="lightmaps">Lightmaps</h2>
<ul>
<li>UVs need to be in 0-1 space</li>
<li>Needs to be unique, i.e. no overlap</li>
<li>Needs to be stored in the second uv channel</li>
<li>You can set the light map resolution and the light map coordinate index inside the static mech editor under the tab static mesh settings.</li>
<li>You can also override the light map resolution in the main editor 3d view by selecting the static mesh and scrolling to lighting section.</li>
</ul>
<h2 id="collision">Collision</h2>
<ul>
<li><strong>Collision mesh</strong>
<ul>
<li>Can be created inside your DCC
<ul>
<li>If we want to create the collision mesh inside our DCC we first model it.</li>
<li>Then we need to name it **UCX_[full name of mesh]_Number**</li>
<li>for instance UCX_MyMesh_00</li>
</ul>
</li>
<li>Or created inside Unreal Engine
<ul>
<li>Go into the static mesh editor</li>
<li>From the main toolbar menu you can use various functions found in the Collision menu to create a collision mesh</li>
<li>You can also use convex decomposition. Make sure that the convex decomposition window is open (Main Menu &gt; Window &gt; Convex Decomposition)</li>
<li>Then we can hit apply (if you do not get the collision mesh you want chnange the parameters and hit apply again)</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="overdraw">Overdraw</h2>
<p>Overdraw is when the engine needs to process a part of a mesh that will later not be used. Lets say we have a plane that we will assign a leaf texture to. To reduce overdraw it is better to use a bit more verts to more closely hug the outline of the leaves than to have large parts that will be invisible.</p>
<p>We can use the view mode shader complexity to view overdraw. View mode &gt; Optimization View Modes &gt; Shader Complexity <strong>Alt 8</strong></p>
<table>
<thead>
<tr>
<th>View Mode</th>
<th>Key</th>
</tr>
</thead>
<tbody>
<tr>
<td>Lightmap Density</td>
<td>Alt 0</td>
</tr>
<tr>
<td>Wireframe</td>
<td>Alt 2</td>
</tr>
<tr>
<td>Unlit</td>
<td>Alt 3</td>
</tr>
<tr>
<td>Lit</td>
<td>Alt 4</td>
</tr>
<tr>
<td>Detail Lighting</td>
<td>Alt 5</td>
</tr>
<tr>
<td>Lighting Only</td>
<td>Alt 6</td>
</tr>
<tr>
<td>Light Complexity</td>
<td>Alt 7</td>
</tr>
<tr>
<td>Shader Complexity</td>
<td>Alt 8</td>
</tr>
</tbody>
</table>
<h2 id="lod">LOD</h2>
<ul>
<li><strong>Manually creating LODs</strong>
<ul>
<li>Houdini</li>
</ul>
</li>
<li><strong>Automatic LODs</strong></li>
</ul>
<h2 id="import">Import</h2>
<ul>
<li><strong>Importing GEO</strong>
<ul>
<li>Mesh
<ul>
<li>Skeletal Mesh : <strong>OFF</strong>
Turn off for static mash, on for a skeletal mesh</li>
<li>Auto Generate Collision : <strong>ON</strong>
If we want the editor to do that</li>
<li>Import Mesh LODs : <strong>ON</strong><br>
If we have created LODs in our DCC</li>
<li>Generate Lightmap UVs : <strong>OFF</strong><br>
If we have created them in our DCC.</li>
<li>Transform Vertex to Absolute : <strong>ON</strong><br>
Should be on. If not the collision meshes will all have been placed in the origin.</li>
</ul>
</li>
<li>Animation : <strong>OFF</strong><br>
on if it is an animation</li>
<li>Material
<ul>
<li>Import Materials : <strong>OFF</strong><br>
We do this inside UE so no need to import</li>
<li>Import Textures : <strong>OFF</strong><br>
We do this inside UE so no need to import</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Re-import</p>
<ul>
<li><strong>Re-import</strong>
<ul>
<li>If we want to re-import we can just drag and drop in the content browser and the old file will be overritten.</li>
<li>Another way is to RMB click on the asset and choose re-import. Unreal will then use a property called Import Settings &gt; File Path to locate the asset and reimport it. If the asset was not found a file browser will be presented.</li>
</ul>
</li>
</ul>
<p>Auto re-import</p>
<ul>
<li><strong>Auto re-import</strong>
<ul>
<li>If we want unreal to auto re-import assets from a folder here is how we do that.</li>
<li>Open Editor settings &gt; General &gt; Loading &amp; Saving &gt; Directories to Monitor</li>
<li>Then we click the + icon and browse to the folder</li>
<li>Then we set the <strong>Map Directory To</strong> so unreal knows where to import to.</li>
</ul>
</li>
</ul>
<h2 id="export">Export</h2>
<ul>
<li><strong>FBX - Static Mesh</strong>
<ul>
<li>Geometry options to enable
<ul>
<li>Smoothing Groups
<ul>
<li>(not needed in Houdini?)</li>
</ul>
</li>
<li>Triangulate</li>
<li>Preserve Edge Orientation
<ul>
<li>(not needed in Houdini?)</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h1 id="materials">Materials</h1>
<p>The nodes in the material editor are HLSL (High Level Shading Language) functions. Materials needs to be compiled before they can be used in the game. In the top bar of the material editor there is a compile button. There is also a save button that both will compile and save the material. When a material is compiled it is considered static and can not change when the game is running.</p>
<ul>
<li><strong>Material</strong>
<ul>
<li><strong>Material Domain</strong>:<br>
The Domain that trhe materials attributes will be evaluated in. Cwertain pieces of material functionality are only valid in certain domains, for example vertex normal is only valid on a surface.
<ul>
<li>Surface</li>
<li>&hellip;</li>
</ul>
</li>
<li><strong>Blend Mode</strong>:<br>
Determines how the materials color is blended with background colors.
<ul>
<li>Opaque</li>
<li>&hellip;</li>
</ul>
</li>
<li><strong>Shading Model</strong>:<br>
Determines how inputs are combined to create the materials final color.
<ul>
<li>Default Lit</li>
<li>&hellip;</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="master-material">Master Material</h2>
<p>Inside the master material you can use parameter nodes that expose the parameter to the material instance, this can be done for color values, roughness values, textures etc.</p>
<ul>
<li><strong>Do</strong>
<ul>
<li>Do use multiple master materials
<ul>
<li>Master for environment objects</li>
<li>Master for characters</li>
<li>Master for weapons</li>
</ul>
</li>
<li>Consult with the artist what parameters they need exposed
<ul>
<li>This makes sure that only parametrs that makes sense are exposed</li>
<li>Make it more intuitive and fast to work with the material</li>
</ul>
</li>
</ul>
</li>
<li><strong>Do not</strong>
<ul>
<li>Do not make one master material that will work for all objects
<ul>
<li>It is not ppossible to make one material to meets all needs</li>
<li>It can introduce performance issues</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="concepts">Concepts</h3>
<ul>
<li><strong>Material functions</strong>
<ul>
<li>Allows you to share and re-use parts of your material graph
<ul>
<li>If you have a piece of the node network that you need to use in multiple places, concider making a material function. (DRY)</li>
</ul>
</li>
<li>RGB mask packing
<ul>
<li>Stor√≠ng various textures in the R,G &amp; B channels of a texture.
<ul>
<li>A great way to lessen tyhe texture needed in memory</li>
<li>Important to document what are beeing expected so that the user knows what data should go in each channel.</li>
</ul>
</li>
</ul>
</li>
<li>Static switches
<ul>
<li>Allows you to enable or disbale certain parts of the code
<ul>
<li>If you have a part of your code that are quite expensive to run nad thsi functionality is nott needed in some places it could be a good idea to bve able to turn this part of the network off to improve performance.</li>
</ul>
</li>
</ul>
</li>
<li>Feature Level Switch
<ul>
<li>Allows you to make one material that will run on any devide that you target.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="create-a-master-material">Create a Master Material</h3>
<ul>
<li><strong>Create the master material</strong>
<ul>
<li>In the content browser naviagte to where you want your material to be saved</li>
<li>RMB click &gt; Material (in the content browser) and give it a name</li>
<li>Double click to open it in the material editor</li>
</ul>
</li>
<li><strong>Add Base Color</strong>
<ul>
<li>RMB click or Press tab to open the node search field</li>
<li>Start typing vector, and select <strong>Parameters &gt; VectorParameter</strong> from the list</li>
<li>Select the parameter node and in the details panel:
<ul>
<li>General
<ul>
<li>Parameter Name : &ldquo;Base_Color&rdquo;<br>
The namne of the parameter</li>
</ul>
</li>
<li>Material Expression Vector Parameter:
<ul>
<li>Default Value:<br>
This will be the default base color value</li>
</ul>
</li>
<li>Material Expression
<ul>
<li>Group : &ldquo;BaseColor&rdquo;<br>
This is useful &hellip;</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><strong>Add a base color texture node</strong>
<ul>
<li>To add a texture node we can either:
<ul>
<li>Drag and drop the texture from the content browser to the material editor</li>
<li>Or select the texture in the content browser, click one time in the material editor (to give it focus) hold <strong>T</strong> and LMB click in the material editor.</li>
</ul>
</li>
<li>To be able to use the texture sample node as a parameter we need to RMB click it &gt; <strong>Convert to Parameter</strong></li>
<li>On the texture sample node
<ul>
<li>General
<ul>
<li>Parameter Name : &ldquo;Base_Color_Texture&rdquo;</li>
<li>Group : &ldquo;BaseColor&rdquo;<br>
This should be found in the dropdown since we already created a group called the same.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><strong>Create a Static Switch node (base color)</strong>
<ul>
<li>In this material we want the ability to switch between a base color or to use a texture for the base color.</li>
<li>RMB click or press tab, then start typing &ldquo;switch&rdquo; in the node search field</li>
<li>Select <strong>Parameters &gt; StaticSwitchParameter</strong> and press enter.</li>
<li>As the parameter name use something that describes what the switch does for instance &ldquo;UseTextureAsBasecolor&rdquo;</li>
<li>Also make sure that the group is set to &ldquo;BaseColor&rdquo;</li>
<li>Then we connect the output from the texture sample node to the True input of the switch node and the output from the vectorParameter node (that we use for base color) to the False input.</li>
</ul>
</li>
<li><strong>Create a parameter to control Metallic</strong>
<ul>
<li>Hold the 1 key and LMB click in the material editor, this will create a 1D constant node</li>
<li>RMB click &gt; Convert to Parameter.
<ul>
<li>General
<ul>
<li>Parameter Name : &ldquo;Metallic&rdquo;</li>
</ul>
</li>
<li>Material Expression Scalar Parameter:
<ul>
<li>Default Value: 0.0<br>
This will be the default metallic value</li>
<li>Slider Min : 0.0<br>
Because the min of a metallic shopuld be 0.0</li>
<li>Slider Max : 1.0<br>
Because the max of a metallic shopuld be 1.0</li>
</ul>
</li>
<li>Material Expression
<ul>
<li>Group : &ldquo;Metallic&rdquo;</li>
</ul>
</li>
</ul>
</li>
<li>Connecdt to the <strong>Metallic</strong> slot of the material.</li>
</ul>
</li>
<li><strong>Setup a packed texture to be used as roughness</strong>
<ul>
<li>Drag and drop the texture (that have packed channels) in the material editor</li>
<li>RMB click the texture sample node &gt; <strong>Convert to Parameter</strong></li>
<li>Set the parameter name
<ul>
<li>General &gt; Parameter Name : &ldquo;Roughness_Texture&rdquo;</li>
</ul>
</li>
<li>Set the group
<ul>
<li>Material Expression &gt; Group : &ldquo;Roughness&rdquo;</li>
</ul>
</li>
<li>Change the sampler type to masks since we want to access a packed channel
<ul>
<li>Material Expression Texture Base &gt; Sampler Type : <strong>Masks</strong></li>
<li><strong>NOTE</strong>
<ul>
<li>I get an error when the smapler type is set to masks, look into this&hellip;</li>
<li>[SM5] (Node TextureSampleParameter2D) TextureSampleParameter&gt; Sampler type is Masks, should be Color for /Game/StarterContent/Textures/T_Brick_Clay_New_M.T_Brick_Clay_New_M</li>
</ul>
</li>
</ul>
</li>
<li>Then we want to create a mask parameter node that let us choose which channel of the texture we want to use as our roughness
<ul>
<li>RMB click, tab &gt; 	<strong>Parameters &gt; StaticComponentMaskParameter</strong></li>
<li>On the node give it the name &ldquo;Roghness Masks&rdquo;</li>
<li>In the Material Expression &gt; group field we also add &ldquo;Roughness&rdquo;</li>
</ul>
</li>
<li>Connect the output from the texture sample node to the input of the mask parameter.</li>
<li>Then we will create a lerp node that will let us adjust the roughness texture
<ul>
<li>Hold the L key and click in the material editor</li>
<li>Connect the output from the mask parameter to the input of the lerp node</li>
<li>then we will create to 1D constants that we will use as parameter for the A (min) and B (max) of the lerp node.</li>
<li>Hold thw 1 key and click to times in the material editor</li>
<li>Select both of the nodes, RMB &gt; Convert to Parameter.</li>
<li>Select one of the parameter nodes
<ul>
<li>Set the parameter name
<ul>
<li>General &gt; Parameter Name : &ldquo;Roughness_Low&rdquo;</li>
</ul>
</li>
<li>Set the group
<ul>
<li>Material Expression &gt; Group : &ldquo;Roughness&rdquo;</li>
</ul>
</li>
<li>Set min, max and default values
<ul>
<li>Material Expression Scalar Parameter
<ul>
<li>Default Value : 0.0</li>
<li>Slider Min : 0.0001</li>
<li>Slider Max : 1.0</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Select the other parameter nodes
<ul>
<li>Set the parameter name
<ul>
<li>General &gt; Parameter Name : &ldquo;Roughness_High&rdquo;</li>
</ul>
</li>
<li>Set the group
<ul>
<li>Material Expression &gt; Group : &ldquo;Roughness&rdquo;</li>
</ul>
</li>
<li>Set min, max and default values
<ul>
<li>Material Expression Scalar Parameter
<ul>
<li>Default Value : 0.5</li>
<li>Slider Min : 0.001</li>
<li>Slider Max : 1.0</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Then we will connect &ldquo;roughness_low&rdquo; to the A on the lerp node and &ldquo;roughness_high&rdquo; to the B.</li>
</ul>
</li>
<li>Then we will connect the output of the lerp node to the roughness input of our material.</li>
</ul>
</li>
<li><strong>Add a normal map</strong>
<ul>
<li>Drag and drop the normal texture in the material editor</li>
<li>RMB click the texture node &gt; Convert to Parameter</li>
<li>Set the parameter name
<ul>
<li>General &gt; Parameter Name : &ldquo;Normal_Map&rdquo;</li>
</ul>
</li>
<li>Set the group
<ul>
<li>Material Expression &gt; Group : &ldquo;Normal&rdquo;</li>
</ul>
</li>
<li>Make sure the the sampler tyoe is set to Normal</li>
<li>Then we connect the output of this node to the Normal input of the material. <strong>Note</strong> that we can RMB click the output pin &gt; <strong>Connect to Normal</strong></li>
</ul>
</li>
</ul>
<h3 id="modify-our-master-material">Modify our master material</h3>
<p>As said before, it is wise to create different master materials for different use cases instead of trying to create a one size fits all master material. One quick way to create a new master material is to edit an existing master material. Lets edit the one we just created so that we can use it as a glass material.</p>
<ul>
<li>RMB click the master material &gt; <strong>Duplicate (Ctrl W)</strong></li>
<li>Lets call it MAT_Glass_Master</li>
<li>To make a material &ldquo;transparent&rdquo; we need to change the Blend Mode to Translucent or Masked the difference is
<ul>
<li><strong>Translucent</strong>
<ul>
<li>The material can have a varying range of transparency.</li>
<li>This is more expensive than using a mask, but looks better</li>
<li>If the Blend Mode is set to <strong>Translucent</strong> the <strong>Opacity</strong> slot on the material is available</li>
</ul>
</li>
<li><strong>Masked</strong>
<ul>
<li>The material transparency is either on or off, based on the mask channel.</li>
<li>If the Blend Mode is set to <strong>Masked</strong> the <strong>Opacity Mask</strong> slot on the material is available</li>
</ul>
</li>
</ul>
</li>
<li>Set <strong>Material &gt; Blend Mode &gt; Translucent</strong></li>
<li>Set <strong>Translucency &gt; Lighting Mode &gt; Surface ForwardShading</strong>
<ul>
<li>This gives the best light / translucency interaction but is also the most expensive.</li>
<li><strong>NOTE</strong> this is inside the translucency tab</li>
</ul>
</li>
<li>Hold 1 key and LMB click in the material editor to create a float constant</li>
<li>RMB click and convert it to a parameter</li>
<li>Edit properties
<ul>
<li>Set the parameter name
<ul>
<li>General &gt; Parameter Name : &ldquo;Opacity&rdquo;</li>
</ul>
</li>
<li>Set the group
<ul>
<li>Material Expression &gt; Group : &ldquo;Opacity&rdquo;</li>
</ul>
</li>
<li>Set min, max and default values
<ul>
<li>Material Expression Scalar Parameter
<ul>
<li>Default Value : 0.25</li>
<li>Slider Min : 0.0001</li>
<li>Slider Max : 1.0</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Lets remove the base color setup we did (delete base color texture and the static switch) and just plug the base color (vec3 parm) directly into the base color input of the material.</li>
<li>We will keep our roughness setup since that gives a lot of flexibility</li>
<li>We can obviously change the roughness texture aswell as the normal map to better fit the glass material. This can also be changed in the material instance at a later stage.</li>
</ul>
<h2 id="material-function">Material Function</h2>
<p>A material function is a way to share code between materials and keeping the behaviour consistent across materials.</p>
<ul>
<li>In the content browser, navigate to the desired location.</li>
<li>RMB &gt; Materials &amp; Textures &gt; Material Function</li>
<li>Give it the name &ldquo;MF_tile_uv&rdquo;</li>
<li>Double click to go inside</li>
<li>Select the Output Result node
<ul>
<li>Material Expression Function Output
<ul>
<li>Output Name : TilingOut</li>
<li>Description : Texture tiling utility</li>
</ul>
</li>
</ul>
</li>
<li>Add a <strong>Texture Coordinate</strong> (Coordinates)</li>
<li>Add a <strong>Functions Input</strong> (Functions)
<ul>
<li>Material Expression Function Input
<ul>
<li>Input Name : &ldquo;Texture Scale&rdquo;</li>
<li>Input Type : Function Input Scalar</li>
<li>Preview Value : X 1.0
<ul>
<li>To preview this input when editing the material function we set the x value (of the XYZW) inputs to 1.0</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Add a multiply, hold M and LMB click.</li>
<li>Connect the output of the Texture Coordinate to the A input of the multiply node and the output of the Function Input to thr B input.</li>
<li>Connect the output from the Multiply node to the input of the Output node</li>
<li>Then press apply and save (I think it is enough tp press save?)</li>
</ul>
<h3 id="use-a-material-function">Use a material function</h3>
<p>Lets use the material function we just created to control the uv tiling of our master material.</p>
<ul>
<li>From the content browser drag and drop the material function into our master material.</li>
<li>Create a 1D constant that we can use to control the texture scale. (Hold 1 key and LMB click to create the node)</li>
<li>RMB click &gt; Convert to Parameter</li>
<li>Set parameters
<ul>
<li>General
<ul>
<li>Parameter Name : &ldquo;Texture Scale&rdquo;</li>
</ul>
</li>
<li>Material Expression Scalar Parameter
<ul>
<li>Default Value : 1.0</li>
<li>Slider Min: 0.5</li>
<li>Slider Max : 25.0</li>
</ul>
</li>
<li>Material Expression
<ul>
<li>Group : &ldquo;UV&rdquo;</li>
</ul>
</li>
</ul>
</li>
<li>Then we will connect the output of our material function to the UV input of all our texture parameter nodes.</li>
</ul>
<h2 id="material-instance">Material Instance</h2>
<p>A material can not change during runtime, this is where material instances comes in. A <strong>Material Instance</strong> can change properties during runtime (color values, textures, etc) and we don not have to recompile that material when we do this. There is a slight performance advantage to use material instances over materials, but this is minimal and only noticable if we use thousands of materials. The main advantage is the flexibility to edit the material properties in runtime and without the need to recompile. You can setup a master material that have tweakable properties that are exposed and editable in the material instances.</p>
<h3 id="creating-a-material-instance">Creating a material instance</h3>
<ul>
<li>
<p>Creating</p>
<ul>
<li>RMB click the master material &gt; Create Material Instance</li>
<li>RMB click the content browser &gt; Materials &amp; Textures &gt; Material Instance
<ul>
<li>This will create an &ldquo;empty material instance&rdquo;</li>
<li>Then we can drag and drop the master material in the parent slot of the material instance (when it is opened in the material editor)</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Material instance</p>
<ul>
<li>Parameter Groups
<ul>
<li>BaseColor</li>
<li>Roughness</li>
<li>Etc&hellip;<br>
The parameters that we createed inside the master material will be placed in the group that we specify on the parameter. If no groups were specified they will end up inside the Global Scalar Parameter Values. Using groups is a nice way to organize the material.</li>
</ul>
</li>
<li>General
<ul>
<li>Phys Material<br>
Used for sounds, effects etc</li>
<li>Parent Material
The master Material (can be set/changed here)</li>
</ul>
</li>
<li>Light Mass Settings</li>
<li>Material Property Overrides<br>
This should only be used to test/try out things. Mayabe quickly test two sided etc. If checges are needed here it is an indication that the master material is probably not a good fit to be used as a parent for this material insatnce.
<ul>
<li>Blend Mode</li>
<li>Shading Model</li>
<li>Two sided</li>
<li>Etc&hellip;</li>
</ul>
</li>
<li>Previewing<br>
Here we can specify which mesh to use for previewing inside the amterial editor.
<ul>
<li>Preview Mesh</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="vertex-animation">Vertex Animation</h2>
<p>Vertex animation is a really cheap way to add complex animation to a mesh. It is run on the GPU and is basically offsetting the vertex positions over time. One limitation of vertex animation is since it is run on the GPU the CPU has no/(limited?) access so it is basically used as eyecandy since we can not easily &ldquo;interact&rdquo; with the animation in gameplay/realtime.</p>
<h3 id="setup-vertex-animation">Setup Vertex animation</h3>
<ul>
<li>In the content browser navigate to where you want to save the material</li>
<li>RMB click &gt; Material (Create Basic Asset)</li>
<li>Give it a good name, and double click to jump in.</li>
<li>We need to change our blend mode to masked, since we are going to use a texture for the leaves that have a mask for the transparency.
<ul>
<li>Material
<ul>
<li>Blend Mode : <strong>Masked</strong></li>
</ul>
</li>
</ul>
</li>
<li>If we are going to use this as texture for leaves we probably want to use a two sided material
<ul>
<li>Material
<ul>
<li>Two Sided : <strong>ON</strong></li>
</ul>
</li>
</ul>
</li>
<li>Lets drag and drop a texture to use for the base color and alpha
<ul>
<li>Connect the RGB to BaseColor</li>
<li>Connect the alpha to Opacity Mask</li>
</ul>
</li>
<li>If we have a normal map, drag and drop, connect to Normal</li>
<li>Lets add a parameter for roughness
<ul>
<li>Hold 1 and LMB click to create a 1D constant, RMB click convert to parameter</li>
<li>Set the parameter name &amp; group to &ldquo;roughness&rdquo;</li>
<li>Default value 0.5, min 0.0, max 1.0</li>
</ul>
</li>
<li>Add the material function that will create the vertex animation
<ul>
<li>RMB or tab and start typing &ldquo;simple&hellip;&rdquo;</li>
<li>Select <strong>Misc &gt; SimplGrassWind</strong> from the list. (I guess this is part of the starter content)</li>
<li>Connect to the <strong>World Position Offset</strong> on the material</li>
<li>Then we need to add some inputs to our simple grass wind material function</li>
<li>We need 2 scalar  and 1 vector constant.
<ul>
<li>Hold 1 and click 2 times in the editor to create the scalar constants</li>
<li>Hold 3 and LMB click to create the vector constant.</li>
<li>If we want to expose this for our material instance we can convert the inputs to parameters, give them nice names, add to suitable groups, set some nice defaults, min and max.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h1 id="performance--optimization">Performance &amp; Optimization</h1>
<h2 id="texture-streaming">Texture streaming</h2>
<p>Texture streaming is using different mipmaps of the texture based on the distance to the camera and where the camera is looking. If you textures appear a bit blurry you might have a problem with the texture streaming. There is pool size for the texture streaming that unreal can fill up with mipmaps. If you use a lot of high resolution textures you might get a warning telling you &ldquo;texture pool size limit exceded&rdquo;. It basically tells you that your pre-allocated memory for textures is running low.</p>
<h3 id="pool-size">Pool Size</h3>
<p>To increase the size of the texture pool size:</p>
<ul>
<li>Console
<ul>
<li>r.Streaming.PoolSize=5000
<ul>
<li>where to number is ther size in MB</li>
</ul>
</li>
</ul>
</li>
<li>DefaultEngine.ini<br>
You can also do this in the DefaultEngine.ini found in the Config folder of your project
<ul>
<li>Under the [/Script/Engine.RenderSettings] you can set
<ul>
<li>r.Streaming.PoolsSize=5000</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="never-stream">Never Stream</h3>
<p>You can set a texture to never stream. This ensures that the highest resolution is always used. This should not be set in most circumstances, but you might want to enable thsi for textures used in UI or that display text that are close to the user.</p>
<ul>
<li>Double click the texture in the content Browser
<ul>
<li>Details panel
<ul>
<li>Level of Detail
<ul>
<li>Never Stream : <strong>on</strong></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="lods--merging-static-meshes">LODs &amp; merging static meshes</h2>
<h3 id="lod-1">LOD</h3>
<ul>
<li>LOD Tips
<ul>
<li>The eye is really good at picking up silouettes, that is why keeping a good silouette of the LODs are important.</li>
<li>To justify the extra memory required by having LODs, the &ldquo;reduction steps&rdquo; between the meshed must not be to small.</li>
<li>Some ballpark percentages when it comes to LOD reduction <strong>75</strong>, <strong>25</strong> and <strong>12</strong>%</li>
<li>The switching between the LODs are based on the screen size the mesh have. If you need to manually set distance you need to eanble LOD Settings &gt; Auto Compute LOD Distances. The current screen size of the mesh is located in the top left corner of the 3D viewport in the static mesh editor.</li>
<li>You can force a LOD model to be used &ldquo;per instance&rdquo; of the static mesh.
<ul>
<li>Select the static mesh in the main editor world outliner</li>
<li>In the details panel Rendering &gt; LOD &gt; Forced LOD Model</li>
<li>You can also set the min LOD to use etc</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Automatic LOD creation tools</p>
<ul>
<li>If you dont have LODs you can easily construct them inside UE, here is how you do it
<ul>
<li>Double click the static mesh to open it in the editor</li>
<li>Expand the <strong>LOD Settings</strong> tab</li>
<li>In the <strong>LOD Group</strong> dropdown you can choose a preset to use<br>
When you change the item selected you will be promted if you want to change the LOD. Click yes to reconstruct the LODs. <strong>Note</strong> theese settings are stored in the BaseEngine.ini file (it is located in the unreal engine install dir. I read somewhere that you can define your own project LOD settings in the Project / Config / DefaultEngine.ini)</li>
<li>If you want to see all your LODs at the same time you enable the <strong>Custom</strong> checkbox in the <strong>LOD Picker</strong> section</li>
</ul>
</li>
</ul>
<h3 id="merge-actor-tool">Merge Actor Tool</h3>
<p>The Merge Actor Tool is used to combine meshes to reduce draw calls and to bake textures to a texture atlas so that we can reduce the number of materiuals used. Here is how it is used.</p>
<ul>
<li>Select the meshes in the world outliner or the viewport.</li>
<li>Window &gt; Developer Tools &gt; Merge Actor
<ul>
<li>This will open up the merge actor tool and display the selected meshes in a list.</li>
</ul>
</li>
<li><strong>Mesh Settings</strong>
<ul>
<li><strong>Pivot Point at Zero</strong> : On<br>
This can be good to use for easy placement of the merged actor. You simply drag it in to the 3D view and reset the trtanslation and it should match up with the original meshes. One drawback is the if you want to translate the mesh the pivot could be really far of the mesh center.</li>
<li><strong>LOD Selection Type</strong> : Use Specific LOD Level<br>
To be able to bake the textures to a texture atlas we need to set this to Use Specific LOD Level</li>
<li><strong>Specific LOD</strong> : 0<br>
We use the 0 LOD to get the most quality. We could later decimate it using the LOD autogeneration tools to further optimize the mesh.</li>
</ul>
</li>
<li><strong>Material Settings</strong>
<ul>
<li><strong>Merge Materials</strong> : On<br>
This will create a texture atlas of all the textures</li>
<li><strong>Material Settings</strong><br>
Here we can adjust the size of the textures, which maps to include, the blend mode of the material etc.
<ul>
<li>Texture Size</li>
<li>Texture Sizing Type<br>
Various ways of how to pack the textures. Which type you should use is a little trial and error and depending on the current assets.</li>
<li>Normal Map</li>
<li>Metallic Map</li>
<li>etc&hellip;</li>
<li>Blend Mode<br>
This will set the blend mode of the parent material.</li>
</ul>
</li>
</ul>
</li>
<li><strong>Landscape Culling</strong>
<ul>
<li>Use Landscape Culling<br>
If enabled all assets the landsacpe will be discarded.</li>
</ul>
</li>
<li><strong>Replace Source Actors</strong> : Off<br>
This is best to keep off. One workflow could be to keep this off and run the merge actor tool.
<ul>
<li>Copy the source actors to the clipboard and paste in a text editor.</li>
<li>Delete the source mesh in Unreal.</li>
<li>Drag in the new merged actor. since we palced the pivot point a zero we can just reset the transform to get the correct position.</li>
<li>If we need to get back the orig actors we can just copy/paste the file that we have stored in our texteditor.</li>
</ul>
</li>
<li>When the tool is run it will promt you for a folder in the content browser where the mesh and textures will be saved.</li>
</ul>
<h3 id="hlod">HLOD</h3>
<p>Hierarchical Level of Detail (or HLOD), in its simplest form, is a way to combine pre-existing Static Mesh Actors into a single HLOD Proxy Mesh and Material (with atlased Textures). Using HLOD may lead to increased performance as they reduce draw calls down to one call per Proxy Mesh as opposed to a draw call for each individual Static Mesh Actor. When generating HLOD Proxy Meshes, there several parameters you can adjust which help define how Static Mesh Actors are grouped together as clusters that will ultimately be built into Proxy Meshes.</p>
<p>A benefit with the HLODs is that it allows us to merge meshes non-destructively. Lets se how we use it.</p>
<ul>
<li>First we need to make sure that HLOD is enabled.
<ul>
<li><strong>World Settings &gt; LOD System &gt; Enable Hierarchical LODSystem</strong> : On</li>
</ul>
</li>
<li>Then we open the HLOD tool
<ul>
<li><strong>Window &gt; Hierarchical LOD Outliner</strong></li>
</ul>
</li>
<li>Then we click the <strong>Generate Clusters</strong> button.</li>
<li>Based on the settings in the Hierarchical LODSetup section (available both the the World Settings and HLOD tool) it will generate clusters. The static meshes that are contained in a cluster will be merged to one. The material will also be merged.</li>
<li>When I find that I need this tool I will come back and update this section. But for now I will stop here :)</li>
</ul>
<h2 id="lighting-shadow--post-process">Lighting, Shadow &amp; Post Process</h2>
<h3 id="lighting">Lighting</h3>
<ul>
<li><strong>Mobility</strong>
<ul>
<li>Static
<ul>
<li>Cheapest</li>
<li>Fast</li>
<li>Completely baked</li>
</ul>
</li>
<li>Stationary
<ul>
<li>Semi-expensive</li>
<li>Can interact with the scene, a dynamic actor will cast a shadow</li>
<li>You can change the light color &amp; intensity at runtime&hellip;</li>
<li>&hellip;But not move them.</li>
</ul>
</li>
<li>Movable
<ul>
<li>Most expensive</li>
<li>Fully dynamic</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="build-lighting">Build Lighting</h3>
<ul>
<li>Build Options
<ul>
<li>Lighting Quality
<ul>
<li>Production
<ul>
<li>Best quality, take a long time, only do before the gameis shipped</li>
</ul>
</li>
<li>High
<ul>
<li>Even better</li>
</ul>
</li>
<li>Medium
<ul>
<li>Slightly slower, but better results</li>
</ul>
</li>
<li>Preview
<ul>
<li>Low quality but really fast, give a indication if the lighting is heading in the right directrion. Fast iteration no need for long builds</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="shadowing">Shadowing</h3>
<ul>
<li><strong>Static Shadows</strong><br>
Baked shadows, nice fallof
<ul>
<li>Static light type</li>
<li>Cheap</li>
<li>No scene interaction</li>
</ul>
</li>
<li><strong>Dynamic Shadows</strong><br>
Dynamic but the shadow fallof does not look as nice as baked
<ul>
<li>Stationary &amp; Moveable light type 
Note that stationary is almost like a mix of a static and moveable (can blend baked shadow with a dynamic shadow, I guess that the shadow fram a static mesh is baked when using stationary?)</li>
<li>Expensive</li>
<li>Scene interaction</li>
</ul>
</li>
</ul>
<p>Other shadow types</p>
<ul>
<li><strong>Cascaded shadows</strong>
<ul>
<li>Only available on directional lights
<ul>
<li>Options under the section Cascaded Shadow Maps</li>
</ul>
</li>
<li>Can &ldquo;blend&rdquo; static and dynamic shadows</li>
<li>Based on the distance from the camera the shadow is blended from dynamic to static for performance reasons.</li>
<li></li>
</ul>
</li>
<li>Distance Field Shadows
<ul>
<li>Uses the mesh distance field to generate the shadow</li>
<li>Really nice quality</li>
<li>Really expensive</li>
<li>Need to enable it under project settings
<ul>
<li>Rendering &gt; Lighting &gt; Generate Mesh Distance Fields</li>
</ul>
</li>
</ul>
</li>
<li>Contact shadows
<ul>
<li>Done in screen space</li>
<li>Add shadows for small details in the mesh</li>
<li>Expensive, use for animatic/cut scenes</li>
<li>Uses paralax occlusion mapping</li>
<li>Point light (only for point light?)
<ul>
<li>Light &gt; Contact Shadow Length : 0.125 and increase
<ul>
<li>keep the values below 1.0</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="post-pross">Post Pross</h3>
<ul>
<li>Post Process Volume
<ul>
<li>Mobile Tone Mapper
<ul>
<li>Only for mobile platforms</li>
</ul>
</li>
<li>Post Process Volume Settings
<ul>
<li>Unbound : <strong>On</strong><br>
If this affects the whole world, if this is off the process will only be used inside the volume</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="volumes">Volumes</h2>
<p>A lot of player interaction can be controlled with volumes, for instance where players are allowed to go, sound effects, postprocesses etc.</p>
<h3 id="lightmass-importance-volumes">Lightmass Importance Volumes</h3>
<ul>
<li>Lightmass Importance Volumes has two purposes:
<ul>
<li><strong>Determines the bounds of the light mass calculation</strong>
<ul>
<li>A good way to speed up the calculation of light in the level. For instance, it would be wasteful to calculate light where the player can not see.</li>
</ul>
</li>
<li><strong>Let dynamic objects know about the static lighting</strong>
<ul>
<li>To do this lighting probes are placed inside to Lightmass Importance Volume and the dynamic objects sample this probes to get lighting information. To view this probes use the show menu in the top left dropdown menu of the 3D view.</li>
<li>Show &gt; Visualize &gt; Volume Lighting Samples</li>
</ul>
</li>
</ul>
</li>
<li>Tips
<ul>
<li>There is no need to get too detailed with multiple voulumes to &ldquo;closely cover&rdquo; the level geo. When the lighting is built the it will look at the min max of the volumes, so do not spend to much time to setup the volumes with multiple volumes.</li>
<li>Make sure it covers the whole playable area, and that it extends a bit below the ground to ensure that everyting is included in the lighting calcualtion</li>
<li>To set the density of the lightmass you go to the World Settings &gt; Lightmass &gt; Lightmass Settings &gt; Static Lighting Level Scale</li>
<li>The <strong>Lightmass Character Indirect Details Volume</strong>
<ul>
<li>is used to add lighting samples where the Lightmass Importance Volumes might not add samples or add to few. Since the samples are placed inside the lightmass importance volume and above the geometry there might be places where samples are needed but not placed when only usimg the lightmass importance volume. An example of this would be an elevator shaft where the elevator will move in the game but when the samples are placed the engine does not not this, so there will be no samples there.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="cull-distance-volumes">Cull Distance Volumes</h3>
<p>Cull Distance Volumes are a useful optimization tool that defines what distance to draw (or make visible) any Actor within the volume. These volumes store any number of size and distance combinations called Cull Distance Pairs. These are mapped to the bounds of an Actor (along its longest dimension) and then assigned to that Actor instance in the level. Cull Distance Volumes are most useful for optimizing large outdoor levels that have detailed interiors. The interiors can be culled when they are small enough to be considered unimportant.</p>
<p>If the cull distance volume does not work for a specfic asset there is also an option on the static mesh actors to specify at distance the should be culled. <strong>Rendering &gt; LOD &gt; Desired Max Draw Distance</strong>
So the workflow could be use the Cull Distance Volume to catch most of the actors, then tweak the ones that does not work i.e. are culled to early or to soon.</p>
<p>Note that you have to be in <strong>game mode</strong> to view the culling.</p>
<h2 id="reflections">Reflections</h2>
<ul>
<li>
<p>Tips</p>
<ul>
<li>You can use the reflection <strong>view mode</strong> to view the reflections</li>
<li>The reflection captures will create one cube map per capture node so adding a lot of them could affect performance.</li>
<li>sphere and box reflection captures will not create reflections of dynamic actors.</li>
<li>Screen space reflections and Planar relections will relect dynamic actors.</li>
<li>You can use a combination of varius reflection types to get the effect that you want.</li>
</ul>
</li>
<li>
<p><strong>Sphere Reflection Capture</strong></p>
<ul>
<li>The most common one</li>
<li>Workflow example
<ul>
<li>Place one large spherical reflection capture to encompass the whole scene, then we could add additional smaller ones to refine certain areas that we want a bit more detailed refelctions.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Box Reflection Capture</strong></p>
<ul>
<li>Mainly use in hallways/long corridors</li>
<li>Could introduce artifacs in the edges</li>
</ul>
</li>
<li>
<p><strong>Planar Reflection</strong></p>
<ul>
<li>Before we can use planar reflection we need to enable:
<ul>
<li><strong>Project Settings &gt; Rendering &gt; Lighting &gt; Support global clip plane for Planar Reflections</strong><br>
What this does is taking a copy of the geometry and flipping it upside down to use for reflections. This means that the cost of the reflection will be directly related to how expensive the meshes and material are.</li>
<li>If you get artifacts in the edges where the reflections meets the meshes you might want to enable the Planar Reflections &gt; Render Scene Two Sided</li>
<li>You can also choose if you want to exclude certain actors, lighting and post-processes from the planar reflection.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Screen Space Reflections</strong></p>
<ul>
<li>This is enabled as a post-process effect</li>
<li>Will give reflections of dynamic actors</li>
<li>Note that a creen space reflections will break down if an object moves out side of the camera frustrum since the effect is based on what is visible to the camera.</li>
</ul>
</li>
</ul>
<h3 id="higher-quality-reflections">Higher Quality Reflections</h3>
<ul>
<li><strong>Reflection Capture Resolution</strong>
<ul>
<li>Project Settings &gt; Rendering &gt; Reflections
<ul>
<li>Reflection Capture Resolution : You could increase this value to get higher quality<br>
Note that for higher values the memory and performance impact could be severe</li>
</ul>
</li>
</ul>
</li>
<li><strong>Sky Light</strong>
<ul>
<li>Increase the cubemap resolution of the Skylight.</li>
</ul>
</li>
<li><strong>Mesh Normal &amp; Tangent encoding</strong>
<ul>
<li><strong>Project Settings</strong> <br>
Selects which GBuffer format should be used. Affects performance primarily via how much GPU memory banwidth used.
<ul>
<li>Rendering &gt; Optimizations &gt; GBuffer Format : <strong>High Precision Normals</strong></li>
</ul>
</li>
<li><strong>Static Mesh</strong><br>
Double click the static mesh in the content browser to open it up in the editor
<ul>
<li>LOD 0 &gt; Build Settings &gt; Use High Precision Tangent Basis : <strong>On</strong></li>
</ul>
</li>
</ul>
</li>
</ul>
		
		</div>
	</div>
</div>
	


        </main>

        

        <footer class="container py-5">

            <div class="row">

                <div class="col-md-6 footer-logo-wrap">
                    <a class="py-2 home-icon" href="https://www.petfactory.se/">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="#e83e8c" width="18" height="18" viewBox="0 0 61.44 61.67"><path class="a" d="M1.28,45.25V56.6a6,6,0,0,0,6,6H18.64A27.07,27.07,0,0,1,8,55.93,25.6,25.6,0,0,1,1.28,45.25Z" transform="translate(-1.28 -1.17)"/><path class="a" d="M28,7.85a27.08,27.08,0,0,1,19.37,7.79L52,20.31,41.35,31,36.9,26.55A13.24,13.24,0,0,0,28,23a12.91,12.91,0,1,0,0,25.82,13.24,13.24,0,0,0,8.9-3.56L62.72,19.42V7.18a6,6,0,0,0-6-6H7.29a6.33,6.33,0,0,0-6,6.23V26.77A28.27,28.27,0,0,1,28,7.85Z" transform="translate(-1.28 -1.17)"/><path class="a" d="M47.36,56.6a27,27,0,0,1-10.24,6.23H56.49a6,6,0,0,0,6-6V41.46Z" transform="translate(-1.28 -1.17)"/></svg>
                    </a>
                    <span class="footer-logo-lext">petfactory &copy; 2023</span>
                </div>

                <div class="col-md-6 social-list">
                    <ul>
                        <li><a target="_blank" class="" href="https://twitter.com/johanBorgstrom"><svg fill="#444" width="20" height="20" viewBox="0 0 16 16"><path d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/></svg>
</a></li>
                        
                        <li><a target="_blank" class="" href="https://www.youtube.com/channel/UCvk7lMI0ihnUr4KSfTlPEfQ"><svg fill="#444" width="20" height="20" viewBox="0 0 64 64"><path d="M54.15,10.031l-20.9-0.019l-21.718,0.019c-5.433,0-11.534,3.626-11.534,8.944v26.474c0,5.316,6.101,8.559,11.534,8.559 H54.15c5.432,0,9.834-3.242,9.834-8.559V18.976C63.984,13.657,59.582,10.031,54.15,10.031z M27.856,42.205L27.73,22.044 l14.03,10.168L27.856,42.205z"/></svg>




</a></li>
                        <li><a target="_blank" class="" href="https://github.com/petfactory"><svg fill="#444" width="20" height="20" viewBox="0 0 16 16"><path d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</a></li>
                        <li><a target="_blank" class="" href="https://linkedin.com/in/johan-borgstr%c3%b6m-8b06875"><svg fill="#444" width="20" height="20" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="1.414"><path d="M13.632 13.635h-2.37V9.922c0-.886-.018-2.025-1.234-2.025-1.235 0-1.424.964-1.424 1.96v3.778h-2.37V6H8.51V7.04h.03c.318-.6 1.092-1.233 2.247-1.233 2.4 0 2.845 1.58 2.845 3.637v4.188zM3.558 4.955c-.762 0-1.376-.617-1.376-1.377 0-.758.614-1.375 1.376-1.375.76 0 1.376.617 1.376 1.375 0 .76-.617 1.377-1.376 1.377zm1.188 8.68H2.37V6h2.376v7.635zM14.816 0H1.18C.528 0 0 .516 0 1.153v13.694C0 15.484.528 16 1.18 16h13.635c.652 0 1.185-.516 1.185-1.153V1.153C16 .516 15.467 0 14.815 0z" fill-rule="nonzero"/></svg></a></li>
                    </ul>
                </div>
            </div>
        </footer>


        
        
        <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
        <script src="https://www.petfactory.se/js/menu.js"></script>
        
    </body>
</html>