<!doctype html>
<html lang="en">

    <head>
        
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

        
        <link rel="icon" href="https://www.petfactory.se/favicons/favicon-32.png" sizes="32x32">

        
        
        
        <link rel="apple-touch-icon" href="https://www.petfactory.se/favicons/favicon-180.png" sizes="180x180">

        
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

        
        <link rel="stylesheet" href="https://www.petfactory.se/css/style.css">
        <link rel="stylesheet" href="https://www.petfactory.se/css/syntax.css">
        <link href="https://fonts.googleapis.com/css2?family=Hind:wght@400;500&display=swap" rel="stylesheet">
        <title>Petfactory | Houdini 18 - Sparse pyro</title>
        <meta name="description" content="Petfactory | Design and Animation | Houdini 18 - Sparse pyro" />

    </head>

    <body>

        <div class="site-header"> 

            <div class="container main-nav-wrap">
                 
                <a class="py-2 home-icon" href="https://www.petfactory.se/">
                    <div class="header-logo-wrap">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="#e83e8c" width="18" height="18" viewBox="0 0 61.44 61.67"><path class="a" d="M1.28,45.25V56.6a6,6,0,0,0,6,6H18.64A27.07,27.07,0,0,1,8,55.93,25.6,25.6,0,0,1,1.28,45.25Z" transform="translate(-1.28 -1.17)"/><path class="a" d="M28,7.85a27.08,27.08,0,0,1,19.37,7.79L52,20.31,41.35,31,36.9,26.55A13.24,13.24,0,0,0,28,23a12.91,12.91,0,1,0,0,25.82,13.24,13.24,0,0,0,8.9-3.56L62.72,19.42V7.18a6,6,0,0,0-6-6H7.29a6.33,6.33,0,0,0-6,6.23V26.77A28.27,28.27,0,0,1,28,7.85Z" transform="translate(-1.28 -1.17)"/><path class="a" d="M47.36,56.6a27,27,0,0,1-10.24,6.23H56.49a6,6,0,0,0,6-6V41.46Z" transform="translate(-1.28 -1.17)"/></svg>
                        
                    </div>
                </a>

                <nav id="main-nav">
    <ul id="main-menu">
        
        
            
                <li>
                    <a href="https://www.petfactory.se/about">
                        
                        <span>ABOUT</span>
                    </a>
                </li>
            
        
            
                <li>
                    <a href="https://www.petfactory.se/work">
                        
                        <span>WORK</span>
                    </a>
                </li>
            
        
            
                <li>
                    <a href="https://www.petfactory.se/cv">
                        
                        <span>CV</span>
                    </a>
                </li>
            
        
            
                <li class="">
                    <a href="https://www.petfactory.se/notes">  
                        
                        <span>NOTES</span>
                    </a>
                    <ul class="sub-menu">
                        
                            <li class="">
                                <a href="https://www.petfactory.se/tags/python-notes">Python</a>
                            </li>
                        
                            <li class="">
                                <a href="https://www.petfactory.se/tags/houdini-notes">Houdini</a>
                            </li>
                        
                            <li class="">
                                <a href="https://www.petfactory.se/tags/unreal-engine-notes">Unreal Engine</a>
                            </li>
                        
                            <li class="">
                                <a href="https://www.petfactory.se/tags/davinci-resolve-notes">DaVinci Resolve</a>
                            </li>
                        
                    </ul>
                </li>
            
        
    </ul>
</nav>

            </div>
            
        </div>


        <div class="site-header-mobile"> 

            
            <div class="menu-wrap">

                <ul>
                    <li><a class="menu-wrap-a" href="https://www.petfactory.se/about">ABOUT</a></li>
                    <li><a class="menu-wrap-a" href="https://www.petfactory.se/work">WORK</a></li>
                    <li><a class="menu-wrap-a" href="https://www.petfactory.se/cv">CV</a></li>
                    <li><a class="menu-wrap-a" href="https://www.petfactory.se/notes">NOTES</a></li>
                </ul>

                
                
                <div id="social-list-modal-wrap">
                    <ul id="social-list-modal">
                        <li><a target="_blank" class="" href="https://twitter.com/johanBorgstrom"><svg fill="#444" width="20" height="20" viewBox="0 0 16 16"><path d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/></svg>
</a></li>
                        
                        <li><a target="_blank" class="" href="https://www.youtube.com/channel/UCB-6-mQgbIn2dUa70D1noTQ"><svg fill="#444" width="20" height="20" viewBox="0 0 64 64"><path d="M54.15,10.031l-20.9-0.019l-21.718,0.019c-5.433,0-11.534,3.626-11.534,8.944v26.474c0,5.316,6.101,8.559,11.534,8.559 H54.15c5.432,0,9.834-3.242,9.834-8.559V18.976C63.984,13.657,59.582,10.031,54.15,10.031z M27.856,42.205L27.73,22.044 l14.03,10.168L27.856,42.205z"/></svg>




</a></li>
                        <li><a target="_blank" class="" href="https://github.com/petfactory"><svg fill="#444" width="20" height="20" viewBox="0 0 16 16"><path d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</a></li>
                        <li><a target="_blank" class="" href="https://linkedin.com/in/johan-borgstr%c3%b6m-8b06875"><svg fill="#444" width="20" height="20" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="1.414"><path d="M13.632 13.635h-2.37V9.922c0-.886-.018-2.025-1.234-2.025-1.235 0-1.424.964-1.424 1.96v3.778h-2.37V6H8.51V7.04h.03c.318-.6 1.092-1.233 2.247-1.233 2.4 0 2.845 1.58 2.845 3.637v4.188zM3.558 4.955c-.762 0-1.376-.617-1.376-1.377 0-.758.614-1.375 1.376-1.375.76 0 1.376.617 1.376 1.375 0 .76-.617 1.377-1.376 1.377zm1.188 8.68H2.37V6h2.376v7.635zM14.816 0H1.18C.528 0 0 .516 0 1.153v13.694C0 15.484.528 16 1.18 16h13.635c.652 0 1.185-.516 1.185-1.153V1.153C16 .516 15.467 0 14.815 0z" fill-rule="nonzero"/></svg></a></li>
                    </ul>
                </div>

            </div>

            <div class="container">

                <a class="py-2 home-icon" href="https://www.petfactory.se/">
                    <div class="header-logo-wrap">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="#e83e8c" width="18" height="18" viewBox="0 0 61.44 61.67"><path class="a" d="M1.28,45.25V56.6a6,6,0,0,0,6,6H18.64A27.07,27.07,0,0,1,8,55.93,25.6,25.6,0,0,1,1.28,45.25Z" transform="translate(-1.28 -1.17)"/><path class="a" d="M28,7.85a27.08,27.08,0,0,1,19.37,7.79L52,20.31,41.35,31,36.9,26.55A13.24,13.24,0,0,0,28,23a12.91,12.91,0,1,0,0,25.82,13.24,13.24,0,0,0,8.9-3.56L62.72,19.42V7.18a6,6,0,0,0-6-6H7.29a6.33,6.33,0,0,0-6,6.23V26.77A28.27,28.27,0,0,1,28,7.85Z" transform="translate(-1.28 -1.17)"/><path class="a" d="M47.36,56.6a27,27,0,0,1-10.24,6.23H56.49a6,6,0,0,0,6-6V41.46Z" transform="translate(-1.28 -1.17)"/></svg>
                    </div>
                </a>

                <a href="javascript:void(0);" class="menu-icon">
                    <div class="mobile-menu-trigger">            
                        <svg fill="#fff" width="18" height="18" viewBox="0 0 18 15"><path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/><path d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/><path d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/></svg>
                    </div>
                </a>

            </div>

        </div>

        <main id="content-main-wrap">

            

<div class="top-spacer"></div>

<div class="container">
	<div class="toc-wrap">
		<aside class="toc-aside">
			<div class="toc-content visible">
				<nav id="TableOfContents">
  <ul>
    <li><a href="#source-points">Source points</a>
      <ul>
        <li><a href="#popnet">Popnet</a></li>
        <li><a href="#point-wrangle">Point Wrangle</a></li>
        <li><a href="#points-out">Points Out</a></li>
      </ul>
    </li>
    <li><a href="#source-volume">Source Volume</a>
      <ul>
        <li><a href="#volume-rasterize-attributes-density">Volume Rasterize Attributes (Density)</a></li>
        <li><a href="#volume-vop-density-noise">Volume VOP (Density Noise)</a></li>
        <li><a href="#volume-rasterize-attributes-velocity">Volume Rasterize Attributes (Velocity)</a></li>
        <li><a href="#volume-vop-velocity-noise">Volume VOP (Velocity Noise)</a>
          <ul>
            <li><a href="#volume-velocity">Volume Velocity</a></li>
            <li><a href="#visualizing-velocity-volume">Visualizing Velocity Volume</a></li>
          </ul>
        </li>
        <li><a href="#merge-density--velocity">Merge Density &amp; Velocity</a>
          <ul>
            <li><a href="#volume-visualization">Volume visualization</a></li>
          </ul>
        </li>
        <li><a href="#source-out">Source Out</a></li>
      </ul>
    </li>
    <li><a href="#sparse-pyro-sim">Sparse Pyro Sim</a>
      <ul>
        <li><a href="#dop-network">DOP Network</a></li>
        <li><a href="#pyro-solver-sparse">Pyro Solver (Sparse)</a></li>
        <li><a href="#smoke-object-sparse">Smoke Object (Sparse)</a></li>
        <li><a href="#volume-source-density--temperature">Volume Source (Density &amp; Temperature)</a></li>
        <li><a href="#micro-solvers">Micro Solvers</a>
          <ul>
            <li><a href="#gas-disturb">Gas Disturb</a></li>
            <li><a href="#gas-turbulency">Gas Turbulency</a></li>
            <li><a href="#gas-dissipate">Gas Dissipate</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#post-sim">Post Sim</a>
      <ul>
        <li><a href="#dop-import-field">DOP Import Field</a></li>
        <li><a href="#volume-visualization-1">Volume Visualization</a></li>
      </ul>
    </li>
  </ul>
</nav>	
			</div>
			<div class="toc-btn"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-three-dots-vertical" viewBox="0 0 16 16">
  <path d="M9.5 13a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z"/>
</svg></div>
		</aside>	
	</div>

</div>


<div class="container notes-wrap">

	<div class="row">
		
		<div class="col-md-10 mx-auto">
			<h1>Houdini 18 - Sparse pyro</h1>
			<p>Some notes on using the sparse pyro solver taken while watching Steven Knippings excellent Volumes III v2.0</p>
<h1 id="source-points">Source points</h1>
<h2 id="popnet">Popnet</h2>
<p>Setup a particle sim that we will use as source for our smoke sim.</p>
<h2 id="point-wrangle">Point Wrangle</h2>
<p>Lets append a point wrangle to the particles. We will use the normailzed age to drive the density of the particles. We will use a ramp parameter and use the normalized age to drive the ramp. There is a built in attribute called <strong>nage</strong> (it will not show in the attr listed on the node but it is there) which is a shortcut for using @age/@life.
We will make the ramp 1 at the beginnign and scale out over nage.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#a6e22e">@pscale</span> <span style="color:#f92672">=</span> chramp(<span style="color:#e6db74">&#39;density_ramp&#39;</span>, <span style="color:#a6e22e">@nage</span>);
<span style="color:#a6e22e">@density</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">1.0</span>;
</code></pre></div><h2 id="points-out">Points Out</h2>
<p>Lets add a <strong>Null</strong> abd call it &ldquo;POINTS&rdquo;</p>
<h1 id="source-volume">Source Volume</h1>
<h2 id="volume-rasterize-attributes-density">Volume Rasterize Attributes (Density)</h2>
<p>Append a volume rasterize attributes to the &ldquo;POINTS&rdquo; null.</p>
<ul>
<li>Volume Rasterize Attributes
<ul>
<li>Attributes: <strong>density</strong></li>
<li>Voxel Size: <strong>ch(&quot;../pyro/smokeobject_sparse1/divsize&rdquo;)</strong>
<ul>
<li>Driven by the simulation voxel size (which we have not created yet)</li>
</ul>
</li>
<li>Coverage Scale: <strong>10</strong>
<ul>
<li>The scale of the coverage (which is density by default)</li>
</ul>
</li>
<li>Particle Scale: <strong>0.5</strong> <sup>(read note below)</sup>
<ul>
<li><strong>Note!</strong> This is just a multiplier of the pscale, (could leave at 1 but in the lesson it was set at 0.5)</li>
</ul>
</li>
<li>Velocity Blur: <strong>On</strong>
<ul>
<li>To make fast moving points appear smoother and less &ldquo;stepped&rdquo; we can use velocity blur</li>
</ul>
</li>
<li>Shutter: <strong>1</strong>
<ul>
<li>The longer the shutter is open the more it will be blured</li>
</ul>
</li>
<li>Shutter Offset: <strong>-1</strong>
<ul>
<li>To make the blur &ldquo;trail&rdquo; the particle</li>
</ul>
</li>
<li>Blur Samples : <strong>8</strong></li>
</ul>
</li>
</ul>
<h2 id="volume-vop-density-noise">Volume VOP (Density Noise)</h2>
<p>Lets add noise to our density volume. Append a volume vop and step in. We will use a 4d vector to sample antialias noise, fit the result and multiply it with the incomming density.</p>
<ul>
<li><strong>Vector to Vector4</strong></li>
<li>connect <strong>P</strong> to the <strong>vec</strong> input and <strong>Time</strong> to <strong>fval4</strong> (the fourth component)</li>
<li><strong>Anti-Aliased Noise</strong>
<ul>
<li>Signature: <strong>4D Input, 1D Noise</strong>
<ul>
<li>Since density is a 1D attribute we will use a 1D noise.</li>
</ul>
</li>
<li>4D Frequency: <strong>2 2 2 1</strong></li>
<li>Amplitude: <strong>X</strong></li>
<li>Roughness: <strong>0.8</strong></li>
</ul>
</li>
<li>Hook up the <strong>hvec</strong> output to the <strong>pos</strong> input of the <strong>aa noise</strong>.</li>
<li>Fit
<ul>
<li>Destination min: <strong>0.1</strong>
<ul>
<li>We use the fit to remap potential negative values to the dest min value. If we raise the dest min we can make sure that we never get 0 density.</li>
</ul>
</li>
</ul>
</li>
<li>connect the aa noise output to the val input of ther fit node</li>
</ul>
<h2 id="volume-rasterize-attributes-velocity">Volume Rasterize Attributes (Velocity)</h2>
<p>Append a volume rasterize attributes to the &ldquo;POINTS&rdquo; null.</p>
<ul>
<li>Volume Rasterize Attributes
<ul>
<li>Attributes: <strong>v</strong></li>
<li>Voxel Size: <strong>ch(&quot;../pyro/smokeobject_sparse1/divsize&rdquo;)</strong>
<ul>
<li>Driven by the simulation voxel size (which we have not created yet)</li>
</ul>
</li>
<li>Coverage Scale: <strong>1</strong>
<ul>
<li>The scale of the coverage (which is density by default)</li>
</ul>
</li>
<li>Particle Scale: <strong>0.5</strong> <sup>(read note below)</sup>
<ul>
<li><strong>Note!</strong> This is just a multiplier of the pscale, (could leave at 1 but in the lesson it was set at 0.5)</li>
</ul>
</li>
<li>Velocity Blur: <strong>Off</strong> <sup>Maybe</sup>
<ul>
<li><strong>Note</strong> if the particles are moving fast there might be gaps in the velocity sourcing between frames, in that case we turn it on.<br>
We could try having it off to introduce more variation to the sim, but for fast moving particles sources definitely keep it on.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="volume-vop-velocity-noise">Volume VOP (Velocity Noise)</h2>
<p>Since the velocity volume is rasterized from a single particle (and therefore only has one velocity attribute) the entire velocity volume have the same velocity. To introduce noise to the volume we will use a Volume VOP.<br>
Append a the <strong>Volume VOP</strong> to the <strong>Volume Rasterize Attributes</strong> (Velocity) node and step in.</p>
<p>Since the default volume in a Volume VOP is set to density we need to explicitly import and export the velocity attribute.</p>
<ul>
<li>Create a <strong>Bind</strong> node and in the attribute <strong>Name</strong> field enter <strong>v</strong> and in the <strong>Type</strong> combobox select <strong>3 Floats (vector)</strong></li>
<li>Create a <strong>Vector to Vector4</strong> node and connect <strong>P</strong> to the <strong>vec</strong> input and <strong>Time</strong> to <strong>fval4</strong> (the fourth component)</li>
<li><strong>Anti-Aliased Noise</strong>
<ul>
<li>Signature: <strong>4D Input, 3D Noise</strong>
<ul>
<li>Since velocity is a 3D attribute we will use a 3D noise.</li>
</ul>
</li>
<li>4D Frequency: <strong>2 2 2 1</strong></li>
<li>Amplitude: <strong>50</strong></li>
<li>Roughness: <strong>0.8</strong></li>
</ul>
</li>
<li>Hook up the <strong>hvec</strong> output to the <strong>pos</strong> input of the <strong>aa noise</strong>.</li>
<li>Create an <strong>Add</strong> node</li>
<li>Connect the output attribute <strong>v</strong> from the <strong>Bind</strong> node to the first input of the add node</li>
<li>Connect the <strong>noise</strong> output from the <strong>AA Noise</strong> node to the second input of the add node.</li>
<li>Create a <strong>Bind Export</strong> and in the attribute <strong>Name</strong> field enter <strong>v</strong> and in the <strong>Type</strong> combobox select <strong>3 Floats (vector)</strong></li>
<li>Connect the <strong>sum</strong> output from the add node to the input of the <strong>Bind Export</strong> node.</li>
</ul>
<h3 id="volume-velocity">Volume Velocity</h3>
<p>Instead of a Volume VOP node we could use a 
<a href="https://www.sidefx.com/docs/houdini/nodes/sop/volumevelocity.html" target="_blank" rel="noopener">Volume Velocity</a> node to add velocity noise to our velocity volume (it has a volume vop inside and some other features). If we use a custom VOP node we might have more control.</p>
<h3 id="visualizing-velocity-volume">Visualizing Velocity Volume</h3>
<p>it might be usefull to visualize the velocity. To do this:</p>
<ul>
<li>Create a <strong>Volume Slice</strong> and append to the <strong>velocity volume rasterize attributes</strong></li>
<li>Create a <strong>Volume Trail</strong> and set the <strong>Volume Slice</strong> as first input and <strong>velocity volume rasterize attributes</strong> as the second input.</li>
</ul>
<h2 id="merge-density--velocity">Merge Density &amp; Velocity</h2>
<p>We want to merge the density- and the velocity-volume so lets create a <strong>merge</strong> node and hook up the two volume nodes. When we do this the vieport visualization might look a bit weird since it is displaying the density aswell as the velocity volumes. The velocity voulme appears as a &ldquo;square&rdquo; volume block. You might also see that it is only appearing in some of the places, this is because negative velocities will not be visible.<br>
To control the display of the volumes we can add a volume visualization node. <strong>Note</strong> that this does not delete or edit volumes it only lets us control the display of the volumes.</p>
<h3 id="volume-visualization">Volume visualization</h3>
<ul>
<li>Volume Visualization
<ul>
<li>Smoke
<ul>
<li>Density Field: <strong>density</strong></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="source-out">Source Out</h2>
<p>Lets add a <strong>Null</strong> and call it &ldquo;SOURCE&rdquo; (connect the output from the volume visualization node)</p>
<h1 id="sparse-pyro-sim">Sparse Pyro Sim</h1>
<h2 id="dop-network">DOP Network</h2>
<p>Create a <strong>DOP Network</strong> and step in. Lets call it <strong>pyro_sim</strong></p>
<ul>
<li>DOP Network
<ul>
<li>Cache
<ul>
<li>Cache Memory: <strong>50000</strong>
<ul>
<li>By default the cache memory is set to 5000 MB - 5GB. If the sim needs more RAM then that it will reuse the memoty already used in the beginning of the sim so we will not be able to play through the time line. Lets allow the sim to use 50 GB instead (or however much memory you have available to be used)</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="pyro-solver-sparse">Pyro Solver (Sparse)</h2>
<p>Create a 
<a href="https://www.sidefx.com/docs/houdini/nodes/dop/pyrosolver_sparse.html" target="_blank" rel="noopener"><strong>Pyro Solver (Sparse)</strong></a> and connect to output.</p>
<ul>
<li>Pyro Solver (Sparse)
<ul>
<li>Simulation
<ul>
<li>Advection/Reflection: <strong>Single-Project</strong>
<ul>
<li>Advection-Reflection attempts to inject energy lost due to pressure projection back into the simulation. Enabling this option may exhibit better vortex retainment in the flow.<br>
<strong>Disabled</strong> No reflection is performed; this is the recommended setting for simulations that involve non-zero goal divergence, such as explosions.<br>
<strong>Single-Project</strong>
Performs a single pressure projection per timestep and adds the removed velocity components back at the next step. This option is marginally slower than Disabled, but requires an extra vector field to be carried between timesteps.<br>
<strong>Double-Project</strong>
Performs two pressure projections and velocity advection passes per timestep. This option is a lot slower than Single-Project, but may yield better results and stability.</li>
</ul>
</li>
</ul>
</li>
<li>Shape
<ul>
<li>Dissipation: <strong>Off</strong></li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Create and merge in a <strong>Ground Plane</strong> between the output and the pyro solver.</p>
<h2 id="smoke-object-sparse">Smoke Object (Sparse)</h2>
<p>Create a <strong>Smoke Object (Sparse)</strong> and connect to the <strong>objects</strong> (1st) input of the pyro solver.</p>
<ul>
<li>Smoke Object
<ul>
<li>Properties
<ul>
<li>Enable Sparse Solving: <strong>On</strong></li>
<li>Voxel Size: <strong>0.05 (lowrez)</strong>
<ul>
<li>We copy this param and let it drive the voxel size of the volume rasterize attr node.<br>
<strong>Note</strong> if we MMB click the smoke object node (or any other with volume fields) we get the dimensions of the voxels. Note that the dimensions are the <strong>bounding box</strong> of the volume and since it is sparse it might use less voxels then a standard pyro solver. To get a high rez volume we can aim for a 600<em>600</em>600 in rez or a max axis of 600.</li>
</ul>
</li>
<li>Max Size: <strong>On</strong>
<ul>
<li>Set a max size of the sim, by default it will expand as the sim evolves. This might be a good idea if the sims expands beyound the camera frustrum, no need to sim something we do not see.<br>
<strong>Note</strong> Instead of entering values on the parms on the smokobject we can create a box in the sop level and copy the dimensions to this parm. It might be easier to do this because then we can easily see the sorce particles and make the box dimension fit.<br>
When we copy the <strong>size</strong> and <strong>center</strong> parms we can <strong>RMB click &gt; Copy Parameter</strong> on the parm name itself and then paste the relative ref on the destination parm. (no need to do it component by component).</li>
</ul>
</li>
</ul>
</li>
<li>Guides
<ul>
<li>Visualization
<ul>
<li>Active Region
<ul>
<li>Displays which region of the sim that is being simulated.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="volume-source-density--temperature">Volume Source (Density &amp; Temperature)</h2>
<p>Create a <strong>Volume Source</strong> and connect to the <strong>sourcing</strong> (3rd) input of the pyro solver.</p>
<p><strong>Note!</strong> if we don´t have an explicit <strong>temperature</strong> source volume we can use the density as temperature source. We do this by typing &ldquo;density&rdquo; in the source volume field of the temperature target field (multi parm at the bottom of the parametar tab added when we initialize to source smoke)</p>
<ul>
<li>Volume Source
<ul>
<li>Input : specify if using <strong>context geometry</strong> or <strong>SOP</strong> path</li>
<li>Initialize: <strong>Source Smoke</strong>
<ul>
<li>Note that we first need to select something else then select source smoke to force the param to update.</li>
</ul>
</li>
<li>Volumes
<ul>
<li>Enlarge Fields to Contain Sources: <strong>On</strong>
<ul>
<li>When the voxel size of the smoke object is small and the sources is moving fast the source may be sourced outside an active region meaning it will not be used by the sim. If checked each target field will be enlarged to enclose its respective source volume.</li>
</ul>
</li>
<li>Operations: 3 (multiparm)</li>
<li>(1st)
<ul>
<li>Field Rank: Scalar</li>
<li>Source Volume: density</li>
<li>Target Field: density</li>
<li>Operation: Add</li>
<li>scale: 1</li>
</ul>
</li>
<li>(2nd)
<ul>
<li>Field Rank: Scalar</li>
<li>Source Volume: <strong>density</strong></li>
<li>Target Field: temperature</li>
<li>Operation: Add</li>
<li>scale: <strong>0.1</strong>
<ul>
<li>Since we set the coverage scale (for density attrib) on the volume rasterize attributes node to 10 and we are using density to drive temperature we set the scale to 0.1 to get a lower temperature.</li>
</ul>
</li>
</ul>
</li>
<li>(3rd)
<ul>
<li>Field Rank: Vector</li>
<li>Source Volume: v</li>
<li>Target Field: vel</li>
<li>Operation: Add</li>
<li>scale: <strong>0.1</strong>
<ul>
<li>Depending on the incomming velocity we adjust the scale to get the look that we want.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="micro-solvers">Micro Solvers</h2>
<p>Create a <strong>Merge</strong> node and connect it to the <strong>Forces</strong> (4:th) input of the pyro solver. Here we can add our various micro solvers.</p>
<h3 id="gas-disturb">Gas Disturb</h3>
<p>Smaller noise features, the micro displacement between the smoke and the surrounding air. Roughing up the edge.</p>
<ul>
<li>Gas Disturb
<ul>
<li>Settings
<ul>
<li>Strength: <strong>2.5</strong></li>
<li>Reference Scale: <em>0.2</em>
<ul>
<li>Roughly the size of the &ldquo;noisy features&rdquo;</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="gas-turbulency">Gas Turbulency</h3>
<p>Bigger displacement, macro wind current, large features.</p>
<ul>
<li>Gas Turbulence
<ul>
<li>Scale: <strong>0.015</strong></li>
<li>Swirl Size: <strong>10</strong></li>
</ul>
</li>
</ul>
<h3 id="gas-dissipate">Gas Dissipate</h3>
<ul>
<li>Diffusion: <strong>0.01</strong>
<ul>
<li>Time based blurring of the field. It can be nice to diffuse somewhat. It gives a contrast between older smoke (more blurred) and the newer (crisper, more detail)</li>
<li>Evaporation Rate: <strong>0.1</strong>
<ul>
<li>If set at 0.1 == remove 10 % of the field every 1 second.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h1 id="post-sim">Post Sim</h1>
<h2 id="dop-import-field">DOP Import Field</h2>
<p>To import the fields from the pyro sim into the SOP level we will use a <strong>DOP Import Field</strong></p>
<ul>
<li>DOP Import Field
<ul>
<li>DOP Network: <strong>&quot;../pyro_sim&rdquo;</strong>
<ul>
<li>Drag and drop the DOP Network node on the input line edit</li>
</ul>
</li>
<li>Default Object: <strong>&ldquo;smokeobject_sparse1&rdquo;</strong></li>
<li>Presets: <strong>Smoke</strong>
<ul>
<li>When we select smoke in the presets combobox the fields associated with a smoke sim will be added in the multi attr section on the import tab. If you know that you do not need some of the fileds, delete them.</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>To control the visualization and get a quick preview of the volumes append a <strong>Volume Visualization</strong> node to the DOP Import Filed node.</p>
<h2 id="volume-visualization-1">Volume Visualization</h2>
<ul>
<li>Volume Visualization
<ul>
<li>Visualization Mode: <strong>Smoke</strong></li>
<li>Density Scale: <strong>2</strong> <sup>Note</sup></li>
<li>Shadow Scale: <strong>1.5</strong> <sup>Note</sup>
<ul>
<li>Note: Just test some values for density and shadow scale to get a quick visualization of the fields.</li>
</ul>
</li>
<li>Smoke
<ul>
<li>Density Field: <strong>density</strong></li>
</ul>
</li>
</ul>
</li>
</ul>
		
		</div>
	</div>
</div>
	


        </main>

        

        <footer class="container py-5">

            <div class="row">

                <div class="col-md-6 footer-logo-wrap">
                    <a class="py-2 home-icon" href="https://www.petfactory.se/">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="#e83e8c" width="18" height="18" viewBox="0 0 61.44 61.67"><path class="a" d="M1.28,45.25V56.6a6,6,0,0,0,6,6H18.64A27.07,27.07,0,0,1,8,55.93,25.6,25.6,0,0,1,1.28,45.25Z" transform="translate(-1.28 -1.17)"/><path class="a" d="M28,7.85a27.08,27.08,0,0,1,19.37,7.79L52,20.31,41.35,31,36.9,26.55A13.24,13.24,0,0,0,28,23a12.91,12.91,0,1,0,0,25.82,13.24,13.24,0,0,0,8.9-3.56L62.72,19.42V7.18a6,6,0,0,0-6-6H7.29a6.33,6.33,0,0,0-6,6.23V26.77A28.27,28.27,0,0,1,28,7.85Z" transform="translate(-1.28 -1.17)"/><path class="a" d="M47.36,56.6a27,27,0,0,1-10.24,6.23H56.49a6,6,0,0,0,6-6V41.46Z" transform="translate(-1.28 -1.17)"/></svg>
                    </a>
                    <span class="footer-logo-lext">petfactory &copy; 2023</span>
                </div>

                <div class="col-md-6 social-list">
                    <ul>
                        <li><a target="_blank" class="" href="https://twitter.com/johanBorgstrom"><svg fill="#444" width="20" height="20" viewBox="0 0 16 16"><path d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/></svg>
</a></li>
                        <li><a target="_blank" class="" href="https://www.youtube.com/channel/UCB-6-mQgbIn2dUa70D1noTQ"><svg fill="#444" width="20" height="20" viewBox="0 0 64 64"><path d="M54.15,10.031l-20.9-0.019l-21.718,0.019c-5.433,0-11.534,3.626-11.534,8.944v26.474c0,5.316,6.101,8.559,11.534,8.559 H54.15c5.432,0,9.834-3.242,9.834-8.559V18.976C63.984,13.657,59.582,10.031,54.15,10.031z M27.856,42.205L27.73,22.044 l14.03,10.168L27.856,42.205z"/></svg>




</a></li>
                        <li><a target="_blank" class="" href="https://github.com/petfactory"><svg fill="#444" width="20" height="20" viewBox="0 0 16 16"><path d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</a></li>
                        <li><a target="_blank" class="" href="https://linkedin.com/in/johan-borgstr%c3%b6m-8b06875"><svg fill="#444" width="20" height="20" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="1.414"><path d="M13.632 13.635h-2.37V9.922c0-.886-.018-2.025-1.234-2.025-1.235 0-1.424.964-1.424 1.96v3.778h-2.37V6H8.51V7.04h.03c.318-.6 1.092-1.233 2.247-1.233 2.4 0 2.845 1.58 2.845 3.637v4.188zM3.558 4.955c-.762 0-1.376-.617-1.376-1.377 0-.758.614-1.375 1.376-1.375.76 0 1.376.617 1.376 1.375 0 .76-.617 1.377-1.376 1.377zm1.188 8.68H2.37V6h2.376v7.635zM14.816 0H1.18C.528 0 0 .516 0 1.153v13.694C0 15.484.528 16 1.18 16h13.635c.652 0 1.185-.516 1.185-1.153V1.153C16 .516 15.467 0 14.815 0z" fill-rule="nonzero"/></svg></a></li>
                    </ul>
                </div>
            </div>
        </footer>


        
        
        <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
        <script src="https://www.petfactory.se/js/menu.js"></script>
        
    </body>
</html>